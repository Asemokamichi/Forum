function containsClass(e,t){return!(!e||"string"!=typeof t)&&!!(e.className&&e.className.trim().split(/\s+/gi).indexOf(t)>-1)}function debounced(e,t){var r;return function(){for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];r&&clearTimeout(r),r=setTimeout((function(){e.apply(void 0,n),r=null}),t)}}function apiForAddBookmark(e){ajax("/api/v1/bookmarks","POST",{course_id:e.getAttribute("data-course-id"),user_id:e.getAttribute("data-user-id")}).then((function(t){e.classList.add("course-action-bookmark-active"),e.querySelector("i").classList.remove("icon-heart"),e.querySelector("i").classList.add("icon-heart-full"),t.id&&e.setAttribute("data-bookmark-id",t.id),t?console.log("Добавлена закладка"):alert("Эта закладка уже существует")})).catch((function(e){console.error(e)}))}function apiForRemoveBookmark(e){ajax("/api/v1/bookmarks/"+e.getAttribute("data-bookmark-id"),"DELETE").then((function(){e.classList.remove("course-action-bookmark-active"),e.querySelector("i").classList.remove("icon-heart"),e.querySelector("i").classList.add("icon-heart-full"),e.removeAttribute("data-bookmark-id"),console.log("Закладка удалена")})).catch((function(e){console.error(e)}))}function apiForRemoveHistory(e){ajax("/api/v1/history/"+e.getAttribute("data-history-id"),"DELETE").then((function(){var t=e.closest(".course");t&&t.remove(),console.log("курс удален из истории")})).catch((function(e){console.error(e)}))}function renderSearchList(e,t,r){t.innerHTML="";var a="https://cdn.coursehunter.net",n="";e.courses&&e.courses.length&&(n+='<div class="main-search-result-box">',n+='<div class="main-search-result-title">Курсы</div>',n+=e.courses.map((function(e){return`\n            <a href="/course/${e.slug}" class="main-search-result-item">\n            <picture class="main-search-picture">\n              <source srcset="${a}/courses/50x50/${e.slug}.webp 1x, ${a}/courses/100x100/${e.slug}.webp 2x" type="image/webp">\n              <img src="${a}/courses/50x50/${e.slug}.jpg" srcset="${a}/courses/100x100/${e.slug}.jpg 2x" class="main-search-img" alt="${e.title}" loading="lazy" width="50" height="50">\n            </picture>\n            <span class="main-search-result-name">${e.title}</span>\n            </a>`})).join(""),n+="</div>"),e.lessons&&e.lessons.length&&(n+='<div class="main-search-result-box">',n+='<div class="main-search-result-title">Встречается в уроках курсов</div>',n+=e.lessons.map((function(e){return`\n            <a href="/course/${e.slug}" class="main-search-result-item">\n            <picture class="main-search-picture">\n              <source srcset="${a}/courses/50x50/${e.slug}.webp 1x, ${a}/courses/100x100/${e.slug}.webp 2x" type="image/webp">\n              <img src="${a}/courses/50x50/${e.slug}.jpg" srcset="${a}/courses/100x100/${e.slug}.jpg 2x" class="main-search-img" alt="${e.title}" loading="lazy" width="50" height="50">\n            </picture>\n            <span class="main-search-result-name">${e.title}</span>\n            </a>`})).join(""),n+="</div>"),e.sources&&e.sources.length&&(n+='<div class="main-search-result-box">',n+='<div class="main-search-result-title">Источники</div>',n+=e.sources.map((function(e){return`<a href="/source/${e.slug}" class="main-search-result-item">\n            <picture class="main-search-picture">\n              <source srcset="${a}/sources/50x50/${e.slug}.webp 1x, ${a}/sources/100x100/${e.slug}.webp 2x" type="image/webp">\n              <img src="${a}/sources/50x50/${e.slug}.jpg" srcset="${a}/sources/100x100/${e.slug}.jpg 2x" class="main-search-img" alt="${e.title}" loading="lazy" width="50" height="50">\n            </picture>\n            <span class="main-search-result-name">${e.title}</span>\n            </a>`})).join(""),n+="</div>"),e.categories&&e.categories.length&&(n+='<div class="main-search-result-box">',n+='<div class="main-search-result-title">Категории</div>',n+=e.categories.map((function(e){return`<a href="/category/${e.slug}" class="main-search-result-item">\n            <picture class="main-search-picture">\n              <source srcset="${a}/categories/50x50/${e.slug}.webp 1x, ${a}/categories/100x100/${e.slug}.webp 2x" type="image/webp">\n              <img src="${a}/categories/50x50/${e.slug}.png" srcset="${a}/categories/100x100/${e.slug}.png 2x" class="main-search-img" alt="${e.title}" loading="lazy" width="50" height="50">\n            </picture>\n            <span class="main-search-result-name">${e.title}</span>\n            </a>`})).join(""),n+="</div>"),e.topics&&e.topics.length&&(n+='<div class="main-search-result-box">',n+='<div class="main-search-result-title">Топики</div>',n+=e.topics.map((function(e){return`<a href="/topic/${e.slug}" class="main-search-result-item">\n            <picture class="main-search-picture">\n              <source srcset="${a}/topics/50x50/${e.slug}.webp 1x, ${a}/topics/100x100/${e.slug}.webp 2x" type="image/webp">\n              <img src="${a}/topics/50x50/${e.slug}.png" srcset="${a}/topics/100x100/${e.slug}.png 2x" class="main-search-img" alt="${e.title}" loading="lazy" width="50" height="50">\n            </picture>\n            <span class="main-search-result-name">${e.title}</span>\n            </a>`})).join(""),n+="</div>"),n&&n.length&&r?r.classList.remove("vh"):r.classList.add("vh"),t.innerHTML=n}function ajax(e="",t="GET",r={}){var a={method:t,mode:"cors",cache:"no-cache",credentials:"same-origin",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("accessToken")},redirect:"follow",referrer:"no-referrer"};return"DELETE"===t&&"GET"===t||(a.body=JSON.stringify(r)),fetch(e,a).then((function(e){return"DELETE"!==t?e.json():e})).catch((function(e){return new Error(e.message)}))}function ratingVote(e){var t=e.currentTarget.getAttribute("data-type")||"course",r="/api/v1/course_rate",a={vote:e.currentTarget.getAttribute("data-vote")};"source"===t?(r="/api/v1/source_rate",Object.assign(a,{source_id:e.currentTarget.getAttribute("data-source-id")})):Object.assign(a,{course_id:e.currentTarget.getAttribute("data-course-id")}),ajax(r,"POST",a).then((function(t){if(t&&t.hasOwnProperty("pos")){var r=e.target.closest(".rang");r.querySelector(".good").innerText=t.pos,r.querySelector(".bad").innerText=t.neg}}))}function dropOpen(e){var t=e.currentTarget.parentElement;if(t.classList)t.classList.add("drop-active");else{var r=t.className.split(" ");r.push("drop-active"),t.className=r.join(" ")}}function dropClose(e){var t=e.currentTarget.parentElement;if(t.classList)t.classList.remove("drop-active");else{var r=t.className.split(" "),a=r.indexOf("drop-active");a>=0&&r.splice(a,1),t.className=r.join(" ")}}function apiSubscribeNewCourse(e){var t=e.target.checked;ajax("/api/v1/subscribe/new-course",t?"POST":"DELETE").then((function(){var r=e.target.getAttribute("data-off"),a=e.target.getAttribute("data-on");e.target.closest("form").querySelector("label").querySelector("span").innerText=t?a:r})).catch((function(e){console.error(e)}))}function apiSubscribeAllSources(e){var t=e.target.checked;ajax("/api/v1/subscribe/new-source",t?"POST":"DELETE").then((function(){var r=e.target.getAttribute("data-off"),a=e.target.getAttribute("data-on");e.target.closest("form").querySelector("label").querySelector("span").innerText=t?a:r})).catch((function(e){console.error(e)}))}function apiSubscribeAllCat(e){var t=e.target.checked;ajax("/api/v1/subscribe/new-category",t?"POST":"DELETE").then((function(){var r=e.target.getAttribute("data-off"),a=e.target.getAttribute("data-on");e.target.closest("form").querySelector("label").querySelector("span").innerText=t?a:r})).catch((function(e){console.error(e)}))}function apiSubscribeNewSources(e){var t=e.target.checked,r=e.target.getAttribute("data-id");ajax("/api/v1/subscribe/source-course",t?"POST":"DELETE",{source_id:r}).then((function(){var r=e.target.getAttribute("data-off"),a=e.target.getAttribute("data-on");e.target.closest("form").querySelector("label").querySelector("span").innerText=t?a:r})).catch((function(e){console.error(e)}))}function apiSubscribeNewCategory(e){var t=e.target.checked,r=e.target.getAttribute("data-id");ajax("/api/v1/subscribe/category-course",t?"POST":"DELETE",{category_id:r}).then((function(){var r=e.target.getAttribute("data-off"),a=e.target.getAttribute("data-on");e.target.closest("form").querySelector("label").querySelector("span").innerText=t?a:r})).catch((function(e){console.error(e)}))}function apiSubscribeUpdateCourse(e){var t=e.target.checked;ajax("/api/v1/subscribe/update-course",t?"POST":"DELETE",{course_id:course_id}).then((function(){var r=e.target.getAttribute("data-off"),a=e.target.getAttribute("data-on");e.target.closest("form").querySelector("label").querySelector("span").innerText=t?a:r})).catch((function(e){console.error(e)}))}!function(e){var t=!1;if("function"==typeof define&&define.amd&&(define(e),t=!0),"object"==typeof exports&&(module.exports=e(),t=!0),!t){var r=window.Cookies,a=window.Cookies=e();a.noConflict=function(){return window.Cookies=r,a}}}((function(){function e(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var a in r)t[a]=r[a]}return t}return function t(r){function a(t,n,o){var c;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(o=e({path:"/"},a.defaults,o)).expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*o.expires),o.expires=s}o.expires=o.expires?o.expires.toUTCString():"";try{c=JSON.stringify(n),/^[\{\[]/.test(c)&&(n=c)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var i="";for(var u in o)o[u]&&(i+="; "+u,!0!==o[u]&&(i+="="+o[u]));return document.cookie=t+"="+n+i}t||(c={});for(var l=document.cookie?document.cookie.split("; "):[],d=/(%[0-9A-Z]{2})+/g,g=0;g<l.length;g++){var p=l[g].split("="),m=p.slice(1).join("=");this.json||'"'!==m.charAt(0)||(m=m.slice(1,-1));try{var v=p[0].replace(d,decodeURIComponent);if(m=r.read?r.read(m,v):r(m,v)||m.replace(d,decodeURIComponent),this.json)try{m=JSON.parse(m)}catch(e){}if(t===v){c=m;break}t||(c[v]=m)}catch(e){}}return c}}return a.set=a,a.get=function(e){return a.call(a,e)},a.getJSON=function(){return a.apply({json:!0},[].slice.call(arguments))},a.defaults={},a.remove=function(t,r){a(t,"",e(r,{expires:-1}))},a.withConverter=t,a}((function(){}))})),document.addEventListener("touchstart",(function(e){}),{passive:!0}),"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js").then((function(e){console.log("SW reg successful with scope: ",e.scope)}),(function(e){console.log("ServiceWorker registration failed: ",e)}))})),window.addEventListener("offline",(function(e){console.log(e)}),!1),window.addEventListener("online",(function(e){console.log(e)}),!1),window.Element&&!Element.prototype.closest&&(Element.prototype.closest=function(e){var t,r=(this.document||this.ownerDocument).querySelectorAll(e),a=this;do{for(t=r.length;--t>=0&&r.item(t)!==a;);}while(t<0&&(a=a.parentElement));return a}),console.log("%cCourseHunter!","font-weight:bold;font-size:50px;color:red;text-shadow:3px 3px 0 rgb(217,31,38),6px 6px 0 rgb(226,91,14),9px 9px 0 rgb(245,221,8),12px 12px 0 rgb(5,148,68),15px 15px 0 rgb(2,135,206),18px 18px 0 rgb(4,77,145),21px 21px 0 rgb(42,21,113)"),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll('[data-type="language-item"]');e&&Array.prototype.forEach.call(e,(function(e){e.addEventListener("click",(function(e){var t=e.currentTarget.getAttribute("data-title");Cookies.set("locale",t),window.location.reload()}))}));var t=document.querySelectorAll('[data-show-more="true"]');t&&Array.prototype.forEach.call(t,(function(e){e.addEventListener("click",(function(e){var t=e.currentTarget.parentElement.querySelector('[data-show-more-content="true"]');t.classList.remove("vh"),t.classList.add("inline"),e.currentTarget.remove()}))}));var r=document.querySelectorAll(".chip-item[data-url]");r&&Array.prototype.forEach.call(r,(function(e){e.addEventListener("click",(function(e){e.currentTarget.parentElement.querySelector(".chip-item-active").classList.remove("chip-item-active"),e.currentTarget.classList.add("chip-item-active");var t=e.currentTarget.getAttribute("data-url");document.querySelector(".book-wrap-pdf object").setAttribute("data",t)}))}));var a=document.querySelector(".nav-toggle");a&&a.addEventListener("click",(function(e){e.currentTarget.closest(".main-header").classList.toggle("nav-open")}));var n=document.querySelectorAll(".nav-li-child-toggle");n&&Array.prototype.forEach.call(n,(function(e){e.addEventListener("click",(function(e){e.currentTarget.closest("li").classList.toggle("nav-li-child-open")}))}));var o=document.getElementsByClassName("course"),c=document.getElementsByClassName("sources-item"),s=document.getElementsByClassName("categories-item"),i=document.getElementById("localSearch"),u=function(e,t){for(var r=0,a=e.length;r<a;r++)e[r].getAttribute("data-name").toLowerCase().includes(t)?e[r].removeAttribute("hidden"):e[r].setAttribute("hidden","")};if(i){var l=i.closest("form");l&&l.addEventListener("submit",(function(e){e.preventDefault()})),i.addEventListener("keyup",(function(e){var t=e.target.value.trim();o&&u(o,t.toLowerCase()),o&&u(c,t.toLowerCase()),o&&u(s,t.toLowerCase())}))}var d=document.querySelector(".course-wrap-description");d&&d.addEventListener("click",(function(e){e.currentTarget.classList.add("course-wrap-description-opened")}));var g=document.getElementById("subToAll");g&&g.addEventListener("change",apiSubscribeNewCourse);var p=document.getElementById("subToAllSources");p&&p.addEventListener("change",apiSubscribeAllSources);var m=document.getElementById("subToAllCat");m&&m.addEventListener("change",apiSubscribeAllCat);var v=document.getElementById("subToSource");v&&v.addEventListener("change",apiSubscribeNewSources);var h=document.getElementById("subToAllCategory");h&&h.addEventListener("change",apiSubscribeNewCategory);var f=document.getElementById("subToCourseUpdate");f&&f.addEventListener("change",apiSubscribeUpdateCourse);var b=document.querySelector(".book-wrap-more");b&&b.addEventListener("click",(function(e){e.target.closest(".book-wrap-description").classList.toggle("book-wrap-description-open")}));var y=document.querySelectorAll(".drop");y&&y.length&&Array.prototype.forEach.call(y,(function(e){e.addEventListener("mouseover",dropOpen,!1),e.addEventListener("mouseout",dropClose,!1)}));var E=document.querySelectorAll(".drop-target");E&&E.length&&Array.prototype.forEach.call(E,(function(e){e.addEventListener("click",(function(e){window.innerWidth<768&&(e.preventDefault(),e.stopPropagation())}))}));var L=document.getElementById("positive-rank");L&&L.addEventListener("click",ratingVote);var x=document.getElementById("negative-rank");x&&x.addEventListener("click",ratingVote);var S=document.querySelectorAll(".theme-btn");S&&S.length&&Array.prototype.forEach.call(S,(function(e){e&&e.addEventListener("click",(function(e){"light"===e.target.getAttribute("data-title")?Cookies.set("theme_light",!0):Cookies.set("theme_light",!1),window.location.reload()}))}));var k=document.querySelectorAll(".course-figure");k&&k.length&&Array.prototype.forEach.call(k,(function(e){e.addEventListener("click",(function(e){window.location.href=e.currentTarget.getAttribute("data-link")}))}));var w=document.querySelectorAll(".course-primary-name");w&&w.length&&Array.prototype.forEach.call(w,(function(e){e.addEventListener("click",(function(e){window.location.href=e.currentTarget.getAttribute("data-link")}))}));var A=document.querySelectorAll(".course-action");A&&A.length&&Array.prototype.forEach.call(A,(function(e){e&&e.addEventListener("click",(function(e){var t=e.currentTarget;containsClass(t,"course-action-bookmark-active")?apiForRemoveBookmark(t):containsClass(t,"course-action-bookmark")?apiForAddBookmark(t):containsClass(t,"course-action-history-remove")&&apiForRemoveHistory(t)}))}));var T=document.querySelector(".main-search");if(T){document.addEventListener("keyup",(function(e){27===e.keyCode&&(T.classList.remove("main-search-active"),document.body.classList.remove("oh"))})),T.querySelector(".main-search-overlay").addEventListener("click",(function(){T.classList.remove("main-search-active"),document.body.classList.remove("oh")})),T.querySelector(".main-search-close").addEventListener("click",(function(){T.classList.remove("main-search-active"),document.body.classList.remove("oh")}));var $=document.querySelector(".main-header-search");$&&$.addEventListener("click",(function(){T.classList.add("main-search-active"),document.body.classList.add("oh"),document.querySelector(".main-search-input").focus()}))}var q=document.getElementById("pageSearch"),C=document.querySelector(".search-result");if(q&&C){q.addEventListener("keyup",debounced((function(e){e.preventDefault();var t=e.target.value,r=new XMLHttpRequest;r.withCredentials=!0,r.addEventListener("readystatechange",(function(){4===this.readyState&&renderSearchList(JSON.parse(this.responseText),C,null)})),r.open("GET","/api/v1/suggestions?query="+encodeURIComponent(t)),r.setRequestHeader("accept","application/json"),r.setRequestHeader("Accept","*/*"),r.send()}),400))}var j=document.querySelector(".main-search");j&&(document.addEventListener("keyup",(function(e){27===e.keyCode&&j.classList.remove("search-active")})),j.addEventListener("click",(function(){j.classList.add("search-active")})),document.addEventListener("click",(function(e){e.target.closest(".main-search")||j.classList.remove("search-active")})));var B=document.querySelector(".notification-toggle");B&&(B.addEventListener("click",(function(){B.closest(".notification-box").classList.toggle("notification-box-active"),ajax("/api/v1/notifications","POST").then()})),document.addEventListener("click",(function(e){e.target.closest(".notification-box.notification-box-active")||B.closest(".notification-box").classList.remove("notification-box-active")})));var O=document.getElementById("mainSearch"),I=document.querySelector(".main-search-result");if(O&&I){var N=document.getElementById("searchBtn");N.addEventListener("click",(function(){O.closest("form").submit()}));const e=function(e){e.preventDefault();var t=e.target.value,r=new XMLHttpRequest;r.withCredentials=!0,r.addEventListener("readystatechange",(function(){4===this.readyState&&renderSearchList(JSON.parse(this.responseText),I,N)})),r.open("GET","/api/v1/suggestions?query="+encodeURIComponent(t)),r.setRequestHeader("accept","application/json"),r.setRequestHeader("Accept","*/*"),r.send()};O.addEventListener("keyup",debounced(e,400))}}));